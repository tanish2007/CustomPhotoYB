<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photo Selection - AI Automatically Picks Your Best Photos</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <h1>Photo Album Selector</h1>
            <p>AI automatically decides which photos to keep based on quality, diversity, and uniqueness</p>
        </header>

        <!-- Upload Section -->
        <section id="upload-section" class="section">
            <div class="upload-card">
                <div class="upload-area" id="drop-zone">
                    <div class="upload-icon">photos</div>
                    <h2>Drop photos here or click to browse</h2>
                    <p>Supports JPG, PNG, HEIC, WebP</p>
                    <input type="file" id="file-input" multiple accept=".jpg,.jpeg,.png,.heic,.heif,.webp" hidden>
                    <button class="btn btn-primary" onclick="document.getElementById('file-input').click()">
                        Select Photos
                    </button>
                </div>

                <!-- Settings -->
                <div class="settings-panel">
                    <h3>Selection Settings</h3>
                    <p class="settings-description">The AI will automatically decide how many photos to keep. You just control how strict it should be.</p>

                    <div class="settings-grid">
                        <div class="setting-item quality-mode-setting">
                            <label>Quality Mode</label>
                            <div class="quality-buttons">
                                <button class="quality-btn" data-mode="lenient" onclick="setQualityMode('lenient')">
                                    <span class="quality-icon">photo_library</span>
                                    <span class="quality-label">Keep More</span>
                                    <span class="quality-desc">Lower standards, more photos</span>
                                </button>
                                <button class="quality-btn active" data-mode="balanced" onclick="setQualityMode('balanced')">
                                    <span class="quality-icon">auto_awesome</span>
                                    <span class="quality-label">Balanced</span>
                                    <span class="quality-desc">Recommended setting</span>
                                </button>
                                <button class="quality-btn" data-mode="strict" onclick="setQualityMode('strict')">
                                    <span class="quality-icon">workspace_premium</span>
                                    <span class="quality-label">Best Only</span>
                                    <span class="quality-desc">Highest quality only</span>
                                </button>
                            </div>
                        </div>

                        <div class="setting-item">
                            <label for="similarity">Duplicate Detection</label>
                            <input type="range" id="similarity" min="0.80" max="0.98" step="0.02" value="0.92">
                            <div class="slider-labels">
                                <span>Keep similar</span>
                                <span id="similarity-value">92%</span>
                                <span>Remove similar</span>
                            </div>
                            <span class="setting-hint">How different photos must be to both be kept</span>
                        </div>
                    </div>

                    <!-- How it works -->
                    <div class="how-it-works">
                        <h4>How the AI Decides:</h4>
                        <div class="criteria-list">
                            <div class="criteria-item">
                                <span class="criteria-icon">face</span>
                                <div>
                                    <strong>Face Quality (35%)</strong>
                                    <p>Clear faces, eyes open, good expressions</p>
                                </div>
                            </div>
                            <div class="criteria-item">
                                <span class="criteria-icon">photo_camera</span>
                                <div>
                                    <strong>Photo Quality (25%)</strong>
                                    <p>Sharp, well-lit, good composition</p>
                                </div>
                            </div>
                            <div class="criteria-item">
                                <span class="criteria-icon">sentiment_very_satisfied</span>
                                <div>
                                    <strong>Emotional Value (20%)</strong>
                                    <p>Expressions, interactions, special moments</p>
                                </div>
                            </div>
                            <div class="criteria-item">
                                <span class="criteria-icon">fingerprint</span>
                                <div>
                                    <strong>Uniqueness (20%)</strong>
                                    <p>Different from other selected photos</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- File Preview -->
                <div id="file-preview" class="file-preview hidden">
                    <h3>Selected Files: <span id="file-count">0</span></h3>
                    <div id="preview-grid" class="preview-grid"></div>
                    <button class="btn btn-success" id="process-btn" onclick="startProcessing()">
                        Let AI Select Best Photos
                    </button>
                </div>
            </div>
        </section>

        <!-- Processing Section -->
        <section id="processing-section" class="section hidden">
            <div class="processing-card">
                <div class="processing-animation">
                    <div class="spinner"></div>
                </div>
                <h2 id="processing-message">Processing your photos...</h2>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <p class="progress-text"><span id="progress-percent">0</span>%</p>

                <div class="processing-steps">
                    <div class="step" id="step-1">
                        <span class="step-icon">brain</span>
                        <span>AI Analysis</span>
                    </div>
                    <div class="step" id="step-2">
                        <span class="step-icon">calendar</span>
                        <span>Date Organization</span>
                    </div>
                    <div class="step" id="step-3">
                        <span class="step-icon">group</span>
                        <span>Grouping Similar</span>
                    </div>
                    <div class="step" id="step-4">
                        <span class="step-icon">star</span>
                        <span>Quality Scoring</span>
                    </div>
                    <div class="step" id="step-5">
                        <span class="step-icon">check</span>
                        <span>Final Selection</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Results Section -->
        <section id="results-section" class="section hidden">
            <div class="results-header">
                <h2>AI Selection Results</h2>
                <div class="results-actions">
                    <button class="btn btn-primary" onclick="downloadSelected()">
                        Download Selected Photos
                    </button>
                    <button class="btn btn-secondary" onclick="resetApp()">
                        Start Over
                    </button>
                </div>
            </div>

            <!-- Summary Stats -->
            <div class="stats-grid" id="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="stat-total">0</div>
                    <div class="stat-label">Total Analyzed</div>
                </div>
                <div class="stat-card highlight">
                    <div class="stat-value" id="stat-selected">0</div>
                    <div class="stat-label">AI Selected</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="stat-rejected">0</div>
                    <div class="stat-label">Filtered Out</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="stat-rate">0%</div>
                    <div class="stat-label">Selection Rate</div>
                </div>
            </div>

            <!-- Rejection Breakdown -->
            <div class="rejection-breakdown" id="rejection-breakdown">
                <h3>Why Photos Were Filtered Out:</h3>
                <div class="rejection-bars" id="rejection-bars"></div>
            </div>

            <!-- Tab Navigation -->
            <div class="tabs">
                <button class="tab active" data-tab="selected" onclick="switchTab('selected')">
                    Selected Photos
                </button>
                <button class="tab" data-tab="rejected" onclick="switchTab('rejected')">
                    Filtered Out
                </button>
            </div>

            <!-- Selected Photos Grid -->
            <div id="selected-tab" class="tab-content active">
                <div class="photo-grid" id="selected-grid"></div>
            </div>

            <!-- Rejected Photos Grid -->
            <div id="rejected-tab" class="tab-content">
                <div class="photo-grid" id="rejected-grid"></div>
            </div>
        </section>

        <!-- Photo Modal -->
        <div id="photo-modal" class="modal hidden">
            <div class="modal-content">
                <span class="modal-close" onclick="closeModal()">&times;</span>
                <img id="modal-image" src="" alt="">
                <div class="modal-info">
                    <h3 id="modal-filename"></h3>
                    <div id="modal-reason" class="modal-reason"></div>
                    <div class="score-breakdown" id="modal-scores"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/app.js"></script>
</body>
</html>
